(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29400,        889]
NotebookOptionsPosition[     27962,        837]
NotebookOutlinePosition[     28352,        854]
CellTagsIndexPosition[     28309,        851]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["ANN Construction of Homogeneous Gas Model", "Text",
 CellChangeTimes->{{3.634476522219532*^9, 3.63447654914915*^9}}],

Cell["Define two density matrices", "Text",
 CellChangeTimes->{{3.634476615144537*^9, 3.634476636981267*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rho", "[", "t_", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r11", "[", "t", "]"}], ",", 
       RowBox[{"r12", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r21", "[", "t", "]"}], ",", 
       RowBox[{"r22", "[", "t", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rhob", "[", "t_", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rb11", "[", "t", "]"}], ",", 
       RowBox[{"rb12", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rb21", "[", "t", "]"}], ",", 
       RowBox[{"rb22", "[", "t", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.634476680475963*^9, 3.634476681285619*^9}, {
  3.6344767650069237`*^9, 3.634476849006476*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"r11", "[", "t", "]"}], 
      RowBox[{"r12", "[", "t", "]"}]},
     {
      RowBox[{"r21", "[", "t", "]"}], 
      RowBox[{"r22", "[", "t", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.634476850877844*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"rb11", "[", "t", "]"}], 
      RowBox[{"rb12", "[", "t", "]"}]},
     {
      RowBox[{"rb21", "[", "t", "]"}], 
      RowBox[{"rb22", "[", "t", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.634476850899823*^9}]
}, Open  ]],

Cell["\<\
To write down the decomposition of density matrice, I could just find the \
four equations. To do so I need the following matrices\
\>", "Text",
 CellChangeTimes->{{3.634476864595965*^9, 3.634476910732519*^9}, {
  3.6344770252045317`*^9, 3.634477052275619*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bM", "=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bM11", ",", "bM12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bM21", ",", "bM22"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elM", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6344770557889977`*^9, 3.634477112909827*^9}, {
  3.634477186028061*^9, 3.634477196985236*^9}, {3.634477324025156*^9, 
  3.634477361287499*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["bM11", "2"], 
      FractionBox["bM12", "2"]},
     {
      FractionBox["bM21", "2"], 
      FractionBox["bM22", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634477104576673*^9, 3.634477113368608*^9}, {
  3.634477356606477*^9, 3.6344773620416117`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634477104576673*^9, 3.634477113368608*^9}, {
  3.634477356606477*^9, 3.634477362048341*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hbar", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"delm2E", ";", " ", 
  RowBox[{"(*", 
   RowBox[{"This", " ", "is", " ", 
    RowBox[{
     RowBox[{"deltam", "^", "2"}], "/", "2"}], "E"}], "*)"}], 
  "\[IndentingNewLine]", "lambda", ";"}], "\[IndentingNewLine]", 
 RowBox[{"gF", ";"}]}], "Input",
 CellChangeTimes->{{3.634477452500519*^9, 3.634477455372817*^9}, 
   3.63447758444668*^9, {3.634478010174283*^9, 3.6344780386606092`*^9}, {
   3.63448976277246*^9, 3.6344897744758387`*^9}}],

Cell["Define Hamiltonians", "Text",
 CellChangeTimes->{{3.6344776000076427`*^9, 3.634477609084098*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Clear", "[", 
    RowBox[{"hamil", ",", "hamilb"}], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"hamil", "[", "t_", "]"}], "=", 
     RowBox[{
      RowBox[{"delm2E", " ", "bM"}], " ", "+", 
      RowBox[{"lambda", " ", "elM"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"Sqrt", "[", "2", "]"}], "gF", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rho", "[", "t", "]"}], "-", 
         RowBox[{"rhob", "[", "t", "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hamilb", "[", "t_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "delm2E"}], " ", "bM"}], " ", "+", 
      RowBox[{"lambda", " ", "elM"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"Sqrt", "[", "2", "]"}], "gF", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rho", "[", "t", "]"}], "-", 
         RowBox[{"rhob", "[", "t", "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.634477611421908*^9, 3.6344776558838863`*^9}, {
  3.634477765228113*^9, 3.6344778080831957`*^9}, {3.634477933351384*^9, 
  3.634477989342258*^9}, {3.634478769666127*^9, 3.634478816816299*^9}, {
  3.6344896723038588`*^9, 3.634489700656753*^9}, {3.634489745669572*^9, 
  3.634489753441444*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{"bM11", " ", "delm2E"}], "2"], "+", "lambda", "+", 
       RowBox[{
        SqrtBox["2"], " ", "gF", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r11", "[", "t", "]"}], "-", 
          RowBox[{"rb11", "[", "t", "]"}]}], ")"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"bM12", " ", "delm2E"}], "2"], "+", 
       RowBox[{
        SqrtBox["2"], " ", "gF", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r12", "[", "t", "]"}], "-", 
          RowBox[{"rb12", "[", "t", "]"}]}], ")"}]}]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"bM21", " ", "delm2E"}], "2"], "+", 
       RowBox[{
        SqrtBox["2"], " ", "gF", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r21", "[", "t", "]"}], "-", 
          RowBox[{"rb21", "[", "t", "]"}]}], ")"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"bM22", " ", "delm2E"}], "2"], "+", 
       RowBox[{
        SqrtBox["2"], " ", "gF", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r22", "[", "t", "]"}], "-", 
          RowBox[{"rb22", "[", "t", "]"}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6344779939968443`*^9, 3.634478049206311*^9, {3.634478787860958*^9, 
   3.634478818310231*^9}, 3.634489704764106*^9, {3.634489755375565*^9, 
   3.634489778299621*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"bM11", " ", "delm2E"}], "2"]}], "+", "lambda", "+", 
       RowBox[{
        SqrtBox["2"], " ", "gF", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r11", "[", "t", "]"}], "-", 
          RowBox[{"rb11", "[", "t", "]"}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"bM12", " ", "delm2E"}], "2"]}], "+", 
       RowBox[{
        SqrtBox["2"], " ", "gF", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r12", "[", "t", "]"}], "-", 
          RowBox[{"rb12", "[", "t", "]"}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"bM21", " ", "delm2E"}], "2"]}], "+", 
       RowBox[{
        SqrtBox["2"], " ", "gF", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r21", "[", "t", "]"}], "-", 
          RowBox[{"rb21", "[", "t", "]"}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"bM22", " ", "delm2E"}], "2"]}], "+", 
       RowBox[{
        SqrtBox["2"], " ", "gF", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r22", "[", "t", "]"}], "-", 
          RowBox[{"rb22", "[", "t", "]"}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6344779939968443`*^9, 3.634478049206311*^9, {3.634478787860958*^9, 
   3.634478818310231*^9}, 3.634489704764106*^9, {3.634489755375565*^9, 
   3.6344897783085747`*^9}}]
}, Open  ]],

Cell["The two eqns are", "Text",
 CellChangeTimes->{{3.634476889726322*^9, 3.634476926045042*^9}, {
  3.63447701810448*^9, 3.6344770226548*^9}, {3.63447738904452*^9, 
  3.634477434995038*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lhs", "=", 
   RowBox[{
    RowBox[{"I", " ", "hbar", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"rho", "[", "t", "]"}], ",", "t"}], "]"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"hamil", "[", "t", "]"}], ".", 
      RowBox[{"rho", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"rho", "[", "t", "]"}], ".", 
      RowBox[{"hamil", "[", "t", "]"}]}]}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lhs", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"-", "lhs"}], "+", "rhs"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.634477437413074*^9, 3.634477463421948*^9}, {
  3.634477571318186*^9, 3.634477575872065*^9}, {3.634478331712463*^9, 
  3.634478354421891*^9}, {3.6344787474431963`*^9, 3.634478756385466*^9}, {
  3.634478822307124*^9, 3.634478828352078*^9}, {3.6344789935930347`*^9, 
  3.634479008566669*^9}, {3.634479046230226*^9, 3.634479087515708*^9}, {
  3.634479152133953*^9, 3.634479156500703*^9}, {3.634488711511216*^9, 
  3.63448873517629*^9}, {3.6344895616994133`*^9, 3.6344895690228977`*^9}, {
  3.6344901024796247`*^9, 3.634490117516099*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r21", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bM12", " ", "delm2E"}], "-", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"rb12", "[", "t", "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"r12", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "bM21"}], " ", "delm2E"}], "+", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"rb21", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{
         SuperscriptBox["r11", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r22", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bM12", " ", "delm2E"}], "-", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"rb12", "[", "t", "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"r11", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "bM12"}], " ", "delm2E"}], "+", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"rb12", "[", "t", "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"r12", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bM11", " ", "delm2E"}], "-", 
             RowBox[{"bM22", " ", "delm2E"}], "+", 
             RowBox[{"2", " ", "lambda"}], "+", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"rb11", "[", "t", "]"}]}], "+", 
                RowBox[{"rb22", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{
         SuperscriptBox["r12", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r11", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bM21", " ", "delm2E"}], "-", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"rb21", "[", "t", "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"r22", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "bM21"}], " ", "delm2E"}], "+", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"rb21", "[", "t", "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"r21", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "bM11"}], " ", "delm2E"}], "+", 
             RowBox[{"bM22", " ", "delm2E"}], "-", 
             RowBox[{"2", " ", "lambda"}], "+", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"rb11", "[", "t", "]"}], "-", 
                RowBox[{"rb22", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{
         SuperscriptBox["r21", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r21", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "bM12"}], " ", "delm2E"}], "+", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"rb12", "[", "t", "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"r12", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bM21", " ", "delm2E"}], "-", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"rb21", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{
         SuperscriptBox["r22", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634478341207714*^9, 3.634478354944006*^9}, 
   3.634478756790792*^9, 3.6344788292214737`*^9, 3.634479009031048*^9, {
   3.634479071672073*^9, 3.634479088014311*^9}, 3.6344791569908657`*^9, {
   3.634488718970063*^9, 3.634488742735805*^9}, 3.6344895699838257`*^9, 
   3.634489708162809*^9, 3.634489758617828*^9, 3.634489819875486*^9, {
   3.634490106218071*^9, 3.634490117999446*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lhsb", "=", 
   RowBox[{
    RowBox[{"I", " ", "hbar", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"rhob", "[", "t", "]"}], ",", "t"}], "]"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhsb", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"hamilb", "[", "t", "]"}], ".", 
      RowBox[{"rhob", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"rhob", "[", "t", "]"}], ".", 
      RowBox[{"hamilb", "[", "t", "]"}]}]}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lhsb", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhsb", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"-", "lhsb"}], "+", "rhsb"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.63448875223685*^9, 3.634488774412195*^9}, 
   3.634488811912814*^9, {3.63448954179797*^9, 3.634489551911618*^9}, {
   3.634490121486018*^9, 3.634490130316217*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", "delm2E", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"bM21", " ", 
           RowBox[{"rb12", "[", "t", "]"}]}], "-", 
          RowBox[{"bM12", " ", 
           RowBox[{"rb21", "[", "t", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        SqrtBox["2"], " ", "gF", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"r21", "[", "t", "]"}]}], " ", 
           RowBox[{"rb12", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"r12", "[", "t", "]"}], " ", 
           RowBox[{"rb21", "[", "t", "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{
         SuperscriptBox["rb11", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bM12", " ", "delm2E"}], "-", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"r12", "[", "t", "]"}]}]}], ")"}], " ", 
           RowBox[{"rb11", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "bM11"}], " ", "delm2E"}], "+", 
             RowBox[{"bM22", " ", "delm2E"}], "+", 
             RowBox[{"2", " ", "lambda"}], "+", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"r11", "[", "t", "]"}], "-", 
                RowBox[{"r22", "[", "t", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"rb12", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "bM12"}], " ", "delm2E"}], "+", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"r12", "[", "t", "]"}]}]}], ")"}], " ", 
           RowBox[{"rb22", "[", "t", "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{
         SuperscriptBox["rb12", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "bM21"}], " ", "delm2E"}], "+", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"r21", "[", "t", "]"}]}]}], ")"}], " ", 
           RowBox[{"rb11", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bM11", " ", "delm2E"}], "-", 
             RowBox[{"bM22", " ", "delm2E"}], "-", 
             RowBox[{"2", " ", "lambda"}], "+", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"r11", "[", "t", "]"}]}], "+", 
                RowBox[{"r22", "[", "t", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"rb21", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bM21", " ", "delm2E"}], "-", 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", "gF", " ", 
              RowBox[{"r21", "[", "t", "]"}]}]}], ")"}], " ", 
           RowBox[{"rb22", "[", "t", "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{
         SuperscriptBox["rb21", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", "delm2E", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"bM21", " ", 
           RowBox[{"rb12", "[", "t", "]"}]}], "-", 
          RowBox[{"bM12", " ", 
           RowBox[{"rb21", "[", "t", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        SqrtBox["2"], " ", "gF", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r21", "[", "t", "]"}], " ", 
           RowBox[{"rb12", "[", "t", "]"}]}], "-", 
          RowBox[{
           RowBox[{"r12", "[", "t", "]"}], " ", 
           RowBox[{"rb21", "[", "t", "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{
         SuperscriptBox["rb22", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.634488775123563*^9, 3.634488813383*^9, {3.6344895531310263`*^9, 
   3.6344895771642103`*^9}, 3.6344898239303017`*^9, {3.634490123141535*^9, 
   3.634490130897789*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"lhsb", "-", "rhsb"}], ")"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.634488902820492*^9, 3.634488922347539*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", "delm2E", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"bM21", " ", 
      RowBox[{"rb12", "[", "t", "]"}]}], "-", 
     RowBox[{"bM12", " ", 
      RowBox[{"rb21", "[", "t", "]"}]}]}], ")"}]}], "-", 
  RowBox[{
   SqrtBox["2"], " ", "gF", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"r21", "[", "t", "]"}]}], " ", 
      RowBox[{"rb12", "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{"r12", "[", "t", "]"}], " ", 
      RowBox[{"rb21", "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{
    SuperscriptBox["rb11", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.634488918006947*^9, 3.634488922868655*^9}, 
   3.6344898282022142`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mattemp", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"mattemp", ".", "mattemp"}]}], "Input",
 CellChangeTimes->{{3.6344986953231783`*^9, 3.634498716039258*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.634498717228668*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "11"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.634498717309664*^9}]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{-905, Automatic}, {6, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 122, 1, 46, "Text"],
Cell[683, 23, 109, 1, 46, "Text"],
Cell[CellGroupData[{
Cell[817, 28, 1039, 32, 119, "Input"],
Cell[1859, 62, 763, 22, 84, "Output"],
Cell[2625, 86, 767, 22, 84, "Output"]
}, Open  ]],
Cell[3407, 111, 271, 5, 46, "Text"],
Cell[CellGroupData[{
Cell[3703, 120, 801, 24, 119, "Input"],
Cell[4507, 146, 814, 23, 104, "Output"],
Cell[5324, 171, 700, 19, 84, "Output"]
}, Open  ]],
Cell[6039, 193, 533, 12, 119, "Input"],
Cell[6575, 207, 103, 1, 46, "Text"],
Cell[CellGroupData[{
Cell[6703, 212, 1458, 39, 144, "Input"],
Cell[8164, 253, 1923, 57, 108, "Output"],
Cell[10090, 312, 2025, 61, 166, "Output"]
}, Open  ]],
Cell[12130, 376, 192, 3, 46, "Text"],
Cell[CellGroupData[{
Cell[12347, 383, 1391, 34, 144, "Input"],
Cell[13741, 419, 5802, 157, 108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19580, 581, 1032, 29, 144, "Input"],
Cell[20615, 612, 5385, 149, 108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26037, 766, 250, 7, 43, "Input"],
Cell[26290, 775, 850, 27, 65, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27177, 807, 336, 9, 69, "Input"],
Cell[27516, 818, 213, 7, 43, "Output"],
Cell[27732, 827, 214, 7, 101, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
